<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Material Calculator</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; font-family: Arial, sans-serif; }

body {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    background: #f4f6f8;
    padding: 20px;
    gap: 20px;
    flex-wrap: wrap;
}

/* Container for table */
.container {
    background: #fff;
    padding: 20px 25px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    max-width: 900px;
    flex-wrap: wrap;
}

h3 {
    text-align: center;
    margin-bottom: 15px;
}
h4 {
    text-align: center;
    margin-bottom: 10px;
    text-decoration: underline;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    border: 1px solid #ccc;
    padding: 6px;
    text-align: center;
}

th {
    background: #007bff;
    color: #fff;
}

select, input {
    width: 100%;
    padding: 4px;
}

button {
    margin-top: 15px;
    padding: 10px 18px;
    border: none;
    background: #28a745;
    color: #fff;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
}

button:hover {
    background: #218838;
}

#totalRow td {
    background: #e9ecef;
    font-weight: bold;
}

/* Calculator on right side */
.calculator {
    background: #1e1e1e;
    padding: 25px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
    width: 320px;
    flex-shrink: 0;
    height: min-content;
}

.history {
    width: 100%;
    height: 25px;
    background: #2c2c2c;
    border-radius: 10px;
    margin-bottom: 5px;
    padding: 5px 10px;
    font-size: 16px;
    color: #ccc;
    text-align: right;
}

.display {
    width: 100%;
    height: 60px;
    background: #121212;
    border-radius: 15px;
    margin-bottom: 20px;
    text-align: right;
    padding: 10px 15px;
    font-size: 28px;
    color: #fff;
    border: none;
}

.buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

button.calc-btn {
    padding: 20px;
    font-size: 20px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    color: #fff;
    background: #333;
}

button.calc-btn:hover { background: #444; }
button.operator { background: #ff9500; }
button.operator:hover { background: #e08e00; }
button.equal { background: #00b894; grid-column: span 2; }
button.equal:hover { background: #009e77; }
button.clear { background: #e74c3c; }
button.clear:hover { background: #c0392b; }

/* Responsive */
@media (max-width: 1200px) {
    body {
        flex-direction: column;
        align-items: center;
    }
    .calculator {
        margin-top: 20px;
    }
}


/* üî¥ Highlight input */
.red-input {
    background: #ffe6e6 !important;
    border: 2px solid hsl(128, 82%, 83%) !important;
}

/* Remove highlight */
.normal-input {
    background: #fff !important;
    border: 1px solid #ccc !important;
}
.red-input {
    background: #ffe6e6 !important;
    border: 2px solid hsl(128, 82%, 83%) !important;
}

</style>
</head>
<body>
          <a href="index.html">üè† Home</a>
          <br>
<!-- Material Table -->
<div class="container">
<h3>Material Weight & Surface Area List</h3>
<h4>(Note:Highlighted column fill)</h4>

<table id="materialTable">
<thead>
<tr>
    <th>MATERIAL</th>
    <th>DIM 1 (mm)</th>
    <th>DIM 2 (mm)</th>
    <th>THK (mm)</th>
    <th>LENGTH (mm)</th>
    <th>QTY</th>
    <th>WT (kg)</th>
    <th>SURFACE (m¬≤)</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<select onchange="calculateRow(this)">
<option value="">Select</option>
<option value="CHS">CHS</option>
<option value="RHS/SHS">RHS / SHS</option>
<option value="ROUND BAR">ROUND BAR</option>
<option value="FLAT BAR">FLAT BAR</option>
<option value="PLATE">PLATE</option>
<option value="ANGLE/TEE">ANGLE/TEE</option>
<option value="CHANNEL">CHANNEL</option>
<option value="SQ BAR">SQ BAR</option>
<option value="REBAR">REBAR</option>
<option value="HEX BAR">HEX BAR</option>
<!-- HEA -->
<!-- ================= HEB ================= -->
<option value="HEB 100" data-weight="20.4" data-surface="0.80">HEB 100</option>
<option value="HEB 120" data-weight="26.7" data-surface="0.95">HEB 120</option>
<option value="HEB 140" data-weight="33.7" data-surface="1.10">HEB 140</option>
<option value="HEB 160" data-weight="42.6" data-surface="1.30">HEB 160</option>
<option value="HEB 180" data-weight="51.2" data-surface="1.50">HEB 180</option>
<option value="HEB 200" data-weight="61.3" data-surface="1.70">HEB 200</option>
<option value="HEB 220" data-weight="71.3" data-surface="1.95">HEB 220</option>
<option value="HEB 240" data-weight="83.2" data-surface="2.20">HEB 240</option>
<option value="HEB 260" data-weight="93"   data-surface="2.45">HEB 260</option>
<option value="HEB 280" data-weight="103"  data-surface="2.70">HEB 280</option>
<option value="HEB 300" data-weight="117"  data-surface="3.00">HEB 300</option>
<option value="HEB 320" data-weight="127"  data-surface="3.25">HEB 320</option>
<option value="HEB 340" data-weight="134"  data-surface="3.45">HEB 340</option>
<option value="HEB 360" data-weight="146"  data-surface="3.70">HEB 360</option>
<option value="HEB 400" data-weight="171"  data-surface="4.20">HEB 400</option>
<option value="HEB 450" data-weight="211"  data-surface="4.90">HEB 450</option>
<option value="HEB 500" data-weight="245"  data-surface="5.60">HEB 500</option>
<option value="HEB 550" data-weight="291"  data-surface="6.40">HEB 550</option>
<option value="HEB 600" data-weight="337"  data-surface="7.20">HEB 600</option>
<option value="HEB 650" data-weight="385"  data-surface="8.10">HEB 650</option>

<!-- ================= IPN ================= -->
<option value="IPN 80"  data-weight="6"    data-surface="0.45">IPN 80</option>
<option value="IPN 100" data-weight="8.1"  data-surface="0.55">IPN 100</option>
<option value="IPN 120" data-weight="10.4" data-surface="0.65">IPN 120</option>
<option value="IPN 140" data-weight="12.9" data-surface="0.78">IPN 140</option>
<option value="IPN 160" data-weight="15.8" data-surface="0.90">IPN 160</option>
<option value="IPN 180" data-weight="18.8" data-surface="1.05">IPN 180</option>
<option value="IPN 200" data-weight="22.4" data-surface="1.20">IPN 200</option>
<option value="IPN 220" data-weight="26.2" data-surface="1.35">IPN 220</option>
<option value="IPN 240" data-weight="30.7" data-surface="1.55">IPN 240</option>
<option value="IPN 260" data-weight="35.8" data-surface="1.75">IPN 260</option>
<option value="IPN 280" data-weight="41"   data-surface="1.95">IPN 280</option>
<option value="IPN 300" data-weight="46.2" data-surface="2.15">IPN 300</option>
<option value="IPN 320" data-weight="52.7" data-surface="2.40">IPN 320</option>
<option value="IPN 340" data-weight="59.4" data-surface="2.65">IPN 340</option>
<option value="IPN 360" data-weight="66.3" data-surface="2.95">IPN 360</option>
<option value="IPN 380" data-weight="73.4" data-surface="3.20">IPN 380</option>
<option value="IPN 400" data-weight="81"   data-surface="3.50">IPN 400</option>
<option value="IPN 450" data-weight="92"   data-surface="4.00">IPN 450</option>
<option value="IPN 500" data-weight="103"  data-surface="4.50">IPN 500</option>
<option value="IPN 550" data-weight="116"  data-surface="5.10">IPN 550</option>

<!-- ================= IPE ================= -->
<option value="IPE 80"  data-weight="6"    data-surface="0.325">IPE 80</option>
<option value="IPE 100" data-weight="8.1"  data-surface="0.54">IPE 100</option>
<option value="IPE 120" data-weight="10.4" data-surface="0.64">IPE 120</option>
<option value="IPE 140" data-weight="12.9" data-surface="0.76">IPE 140</option>
<option value="IPE 160" data-weight="15.8" data-surface="0.88">IPE 160</option>
<option value="IPE 180" data-weight="18.8" data-surface="1.02">IPE 180</option>
<option value="IPE 200" data-weight="22.4" data-surface="1.18">IPE 200</option>
<option value="IPE 220" data-weight="26.2" data-surface="1.32">IPE 220</option>
<option value="IPE 240" data-weight="30.7" data-surface="1.50">IPE 240</option>
<option value="IPE 270" data-weight="36.2" data-surface="1.75">IPE 270</option>
<option value="IPE 300" data-weight="42.2" data-surface="2.00">IPE 300</option>
<option value="IPE 330" data-weight="49.1" data-surface="2.30">IPE 330</option>
<option value="IPE 360" data-weight="57.1" data-surface="2.65">IPE 360</option>
<option value="IPE 400" data-weight="66.3" data-surface="3.05">IPE 400</option>
<option value="IPE 450" data-weight="77.6" data-surface="3.60">IPE 450</option>
<option value="IPE 500" data-weight="90.7" data-surface="4.20">IPE 500</option>
<option value="IPE 550" data-weight="106"  data-surface="4.85">IPE 550</option>
<option value="IPE 600" data-weight="122"  data-surface="5.50">IPE 600</option>

<!-- ================= HEA ================= -->
<option value="HEA 100" data-weight="16.7" data-surface="0.62">HEA 100</option>
<option value="HEA 120" data-weight="20.4" data-surface="0.74">HEA 120</option>
<option value="HEA 140" data-weight="25.3" data-surface="0.88">HEA 140</option>
<option value="HEA 160" data-weight="30.4" data-surface="1.02">HEA 160</option>
<option value="HEA 180" data-weight="35.5" data-surface="1.16">HEA 180</option>
<option value="HEA 200" data-weight="42.3" data-surface="1.32">HEA 200</option>
<option value="HEA 220" data-weight="50.5" data-surface="1.50">HEA 220</option>
<option value="HEA 240" data-weight="60.3" data-surface="1.70">HEA 240</option>
<option value="HEA 260" data-weight="68.2" data-surface="1.90">HEA 260</option>
<option value="HEA 280" data-weight="76.4" data-surface="2.10">HEA 280</option>
<option value="HEA 300" data-weight="88.3" data-surface="2.35">HEA 300</option>
<option value="HEA 320" data-weight="97.6" data-surface="2.55">HEA 320</option>
<option value="HEA 340" data-weight="105"  data-surface="2.75">HEA 340</option>
<option value="HEA 360" data-weight="115"  data-surface="3.00">HEA 360</option>
<option value="HEA 400" data-weight="134"  data-surface="3.40">HEA 400</option>
<option value="HEA 450" data-weight="159"  data-surface="3.95">HEA 450</option>
<option value="HEA 500" data-weight="187"  data-surface="4.55">HEA 500</option>
<option value="HEA 550" data-weight="219"  data-surface="5.20">HEA 550</option>
<option value="HEA 600" data-weight="252"  data-surface="5.90">HEA 600</option>
<option value="HEA 650" data-weight="289"  data-surface="6.60">HEA 650</option>

<!-- ================= UPN ================= -->
<option value="UPN 50"  data-weight="5.59" data-surface="0.232">UPN 50</option>
<option value="UPN 60"  data-weight="5.07" data-surface="0.253">UPN 60</option>
<option value="UPN 65"  data-weight="7.09" data-surface="0.273">UPN 65</option>
<option value="UPN 80"  data-weight="8.64" data-surface="0.312">UPN 80</option>
<option value="UPN 100" data-weight="10.6" data-surface="0.372">UPN 100</option>
<option value="UPN 120" data-weight="13.4" data-surface="0.434">UPN 120</option>
<option value="UPN 140" data-weight="16"   data-surface="0.489">UPN 140</option>
<option value="UPN 160" data-weight="18.8" data-surface="0.546">UPN 160</option>
<option value="UPN 180" data-weight="22"   data-surface="0.611">UPN 180</option>
<option value="UPN 200" data-weight="25.3" data-surface="0.661">UPN 200</option>
<option value="UPN 220" data-weight="29.4" data-surface="0.718">UPN 220</option>
<option value="UPN 240" data-weight="33.2" data-surface="0.775">UPN 240</option>
<option value="UPN 260" data-weight="37.9" data-surface="0.834">UPN 260</option>
<option value="UPN 280" data-weight="41.8" data-surface="0.890">UPN 280</option>
<option value="UPN 300" data-weight="46.2" data-surface="0.950">UPN 300</option>
<option value="UPN 320" data-weight="59.5" data-surface="0.982">UPN 320</option>
<option value="UPN 350" data-weight="60.6" data-surface="1.05">UPN 350</option>
<option value="UPN 380" data-weight="63.1" data-surface="1.110">UPN 380</option>
<option value="UPN 400" data-weight="71.8" data-surface="1.180">UPN 400</option>

</select>
</td>
<td><input type="number" oninput="calculateRow(this)"></td>
<td><input type="number" oninput="calculateRow(this)"></td>
<td><input type="number" oninput="calculateRow(this)"></td>
<td><input type="number" value="1000" oninput="calculateRow(this)"></td>
<td><input type="number" value="1" oninput="calculateRow(this)"></td>
<td><span>0</span></td>
<td><span>0</span></td>
</tr>
<tr id="totalRow">
<td colspan="6" style="text-align:right">TOTAL</td>
<td><span id="totalWT">0</span></td>
<td><span id="totalSA">0</span></td>
</tr>
</tbody>
</table>

<button onclick="addRow()">Add Row</button>
<button onclick="downloadExcel()">Download Excel</button>
</div>

<!-- Calculator -->
<div class="calculator">
<div class="history" id="history"></div>
<input type="text" class="display" id="display" readonly>
<div class="buttons">
<button class="calc-btn clear" onclick="clearDisplay()">C</button>
<button class="calc-btn" onclick="appendValue('%')">%</button>
<button class="calc-btn" onclick="appendValue('/')">/</button>
<button class="calc-btn operator" onclick="appendValue('*')">*</button>

<button class="calc-btn" onclick="appendValue('7')">7</button>
<button class="calc-btn" onclick="appendValue('8')">8</button>
<button class="calc-btn" onclick="appendValue('9')">9</button>
<button class="calc-btn operator" onclick="appendValue('-')">-</button>

<button class="calc-btn" onclick="appendValue('4')">4</button>
<button class="calc-btn" onclick="appendValue('5')">5</button>
<button class="calc-btn" onclick="appendValue('6')">6</button>
<button class="calc-btn operator" onclick="appendValue('+')">+</button>

<button class="calc-btn" onclick="appendValue('1')">1</button>
<button class="calc-btn" onclick="appendValue('2')">2</button>
<button class="calc-btn" onclick="appendValue('3')">3</button>
<button class="calc-btn" onclick="appendValue('.')">.</button>
<button class="calc-btn equal" onclick="calculate()">=</button>

<button class="calc-btn" onclick="appendValue('0')" style="grid-column: span 2;">0</button>

</div>
</div>

<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
// Table Calculation
const density = 7850;

function calculateRow(el) {
    const row = el.closest("tr");
    const select = row.cells[0].querySelector("select");
    updateColumnHighlight(row, select.value);
    const opt = select.options[select.selectedIndex];
    const stdWt = parseFloat(opt.getAttribute("data-weight")) || 0;
    const stdSA = parseFloat(opt.getAttribute("data-surface")) || 0;

    const d1 = parseFloat(row.cells[1].querySelector("input").value) || 0;
    const d2 = parseFloat(row.cells[2].querySelector("input").value) || 0;
    const thk = parseFloat(row.cells[3].querySelector("input").value) || 0;
    const len = parseFloat(row.cells[4].querySelector("input").value) || 0;
    const qty = parseFloat(row.cells[5].querySelector("input").value) || 1;

    let wt = 0, sa = 0;
    const L = len / 1000;

    if (stdWt) {
        wt = stdWt * L * qty;
        sa = stdSA * L * qty;
    } else {
        switch(select.value) {
            case 'RHS/SHS':
                wt = ((d1*d2 - (d1-2*thk)*(d2-2*thk))/1000000) * density * len/1000;
                sa = (2*(d1 + d2)/1000) * len/1000;
                break;
            case 'CHS':
                wt = (((Math.PI * Math.pow(d1/2,2)) - (Math.PI * Math.pow((d1-thk*2)/2,2)))/1000000) * density * len/1000;
                sa = (Math.PI*d1/1000) * len/1000;
                break;
            case 'PLATE':
                wt = (d1*d2*thk/1000000000) * density;
                sa = ((d1*d2)/1000000) * 2 + ((d1*thk)/1000000) * 2 + ((thk*d2)/1000000) * 2;
                break;
            case 'ROUND BAR':
                wt = (Math.PI*Math.pow(d1/2,2)/1000000) * density * len/1000;
                sa = (Math.PI*d1/1000) * len/1000;
                break;
            case 'FLAT BAR':
                wt = (d1*thk/1000000) * density * len/1000;
                sa = 2*(d1 + thk)/1000 * len/1000;
                break;
            case 'ANGLE/TEE':
                wt = ((d1 + d2 - thk)*thk/1000000) * density * len/1000;
                sa = 2*(d1 + d2)/1000 * len/1000;
                break;
            case 'CHANNEL':
                wt = ((d1 + d2*2 - thk*2)*thk/1000000) * density * len/1000;
                sa = 2*(d1 + d2 *2 )/1000 * len/1000;
                break;
            case 'SQ BAR':
                wt = (d1*d1/1000000) * density * len/1000;
                sa = 4*d1/1000 * len/1000;
                break;
            case 'REBAR':
                wt = (Math.pow(d1,2)/162.28 * density/7850) * len/1000;
                sa = (Math.PI*d1/1000) * len/1000;
                break;
            case 'HEX BAR':
                wt = (0.006798*Math.pow(d1,2) * density/7850) * len/1000;
                sa = 6*2*d1/2/1.732/1000 * len/1000;

                break;
            default:
                wt = 0;
                sa = 0;
        }
        wt = wt * qty;
        sa = sa * qty;
    }
    

    row.cells[6].querySelector("span").innerText = wt.toFixed(2);
    row.cells[7].querySelector("span").innerText = sa.toFixed(2);

    updateTotals();
}

function updateTotals() {
    let tw = 0, ts = 0;
    document.querySelectorAll("#materialTable tbody tr:not(#totalRow)").forEach(r=>{
        tw += parseFloat(r.cells[6].querySelector("span").innerText) || 0;
        ts += parseFloat(r.cells[7].querySelector("span").innerText) || 0;
    });
    document.getElementById("totalWT").innerText = tw.toFixed(2);
    document.getElementById("totalSA").innerText = ts.toFixed(2);
}

function addRow() {
    const tbody = document.querySelector("#materialTable tbody");
    const base = tbody.rows[0].cloneNode(true);
    base.querySelectorAll("input").forEach(i=>i.value="");
    base.querySelectorAll("span").forEach(s=>s.innerText="0");
    tbody.insertBefore(base, document.getElementById("totalRow"));
}

function downloadExcel() {
    const wb = XLSX.utils.table_to_book(document.getElementById("materialTable"));
    XLSX.writeFile(wb, "Material_Weight_Surface.xlsx");
}

// Calculator
const display = document.getElementById('display');
const history = document.getElementById('history');

function appendValue(value) { display.value += value; }
function clearDisplay() { display.value=''; history.textContent=''; }
function calculate() {
    try { history.textContent = display.value; display.value = eval(display.value); }
    catch { display.value = 'Error'; }
}

document.addEventListener('keydown', (e) => {

    // ‚úÖ ONLY allow calculator keyboard input
    if (document.activeElement === display) {

        const allowedKeys = "0123456789+-*/.%";

        if (allowedKeys.includes(e.key)) {
            appendValue(e.key);

        } else if (e.key === 'Enter') {
            calculate();

        } else if (e.key === 'Backspace') {
            display.value = display.value.slice(0, -1);

        } else if (e.key.toLowerCase() === 'c') {
            clearDisplay();
        }


        e.preventDefault();
    }
});


</script>
<script>
document.addEventListener("contextmenu", function(e) {
  e.preventDefault();
});
</script>

<script>
function updateColumnHighlight(row, material) {

    const dim1 = row.cells[1].querySelector("input"); // DIM 1
    const dim2 = row.cells[2].querySelector("input"); // DIM 2
    const thk  = row.cells[3].querySelector("input"); // THK

    // RESET
    [dim1, dim2, thk].forEach(i => {
        i.classList.remove("red-input");
    });

    // CHS / FLAT BAR ‚Üí DIM1 + THK
    if (
        material === "CHS" || 
        material === "FLAT BAR"
    ) {
        dim1.classList.add("red-input");
        thk.classList.add("red-input");
    }

    // RHS / SHS / PLATE / ANGLE / CHANNEL ‚Üí DIM1 + DIM2 + THK
    else if (
        material === "RHS/SHS" ||
        material === "PLATE" ||
        material === "ANGLE/TEE" ||
        material === "CHANNEL"
    ) {
        dim1.classList.add("red-input");
        dim2.classList.add("red-input");
        thk.classList.add("red-input");
    }

    // ROUND / SQ / REBAR / HEX ‚Üí DIM1 ONLY
    else if (
        material === "ROUND BAR" ||
        material === "SQ BAR" || 
        material === "REBAR" || 
        material === "HEX BAR"
    ) {
        dim1.classList.add("red-input");
    }


 
}
</script>
<script>
function downloadExcel() {

    const table = document.getElementById("materialTable");

    const backups = [];

    // üîπ Handle SELECTS
    table.querySelectorAll("select").forEach(select => {
        const td = select.parentElement;

        backups.push({
            td: td,
            html: td.innerHTML
        });

        const text = select.options[select.selectedIndex]?.text || "";
        td.innerHTML = text;
    });

    // üîπ Handle INPUTS
    table.querySelectorAll("input").forEach(input => {
        const td = input.parentElement;

        backups.push({
            td: td,
            html: td.innerHTML
        });

        td.innerHTML = input.value || "";
    });

    // üîπ Export to Excel
    const wb = XLSX.utils.table_to_book(table, { sheet: "Material List" });
    XLSX.writeFile(wb, "Material_Weight_Surface.xlsx");

    // üîπ Restore original table (inputs + selects)
    backups.forEach(item => {
        item.td.innerHTML = item.html;
    });
}
</script>

</body>
</html>
